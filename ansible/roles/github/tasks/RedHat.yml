---
# RedHat/Rocky/Fedora - Install GitHub CLI

- name: Add GitHub CLI repository
  become: true
  ansible.builtin.shell: |
    dnf config-manager addrepo --from-repofile=https://cli.github.com/packages/rpm/gh-cli.repo || \
    dnf config-manager --add-repo https://cli.github.com/packages/rpm/gh-cli.repo
  args:
    executable: /bin/bash
    creates: /etc/yum.repos.d/gh-cli.repo

- name: Check if GitHub CLI is installed
  ansible.builtin.shell: command -v gh
  register: gh_check
  failed_when: false
  changed_when: false

- name: Install GitHub CLI
  become: true
  ansible.builtin.shell: dnf install -y gh
  args:
    executable: /bin/bash
  when: gh_check.rc != 0
